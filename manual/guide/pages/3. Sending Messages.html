<html>
     <head>
     	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
     	<title>3. Sending Messages</title>
     	<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8">
     </head>
	<body class="body">
		<h2>Sending Messages</h2><p class="paragraph"/>The plugin also provides mechanisms to make sending messages easier. Underneath the hood, messages are sent via an instance of Spring's <a href="http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/jms/core/JmsTemplate.html" target="blank">JmsTemplate</a>. The plugin creates one instance of JmsTemplate named <code> defaultJmsTemplate </code> which uses the connection factory named <code> jmsConnectionFactory </code> .<p class="paragraph"/><h3>The jmsService</h3><p class="paragraph"/>This plugin adds a service called <code> jmsService </code> to your application that can be used to send JMS messages.<p class="paragraph"/><h4>The send(destination, message, jmsTemplateBeanName, postProcessor) method.</h4><p class="paragraph"/><strong class="bold">destination</strong><p class="paragraph"/>An instance of <code> javax.jms.Destination </code> , <code> javax.jms.Topic </code> , a <code> String </code> or a <code> Map </code> .<p class="paragraph"/>A <code> String </code> destination argument will be interpreted as the name of a destination <em class="italic">queue</em> .<p class="paragraph"/>A <code> Map </code> destination argument can be used in the following ways:<p class="paragraph"/><div class="code"><pre>jmsService.send(queue: <span class="java&#45;quote">"aQueue"</span>, msg, <span class="java&#45;quote">"defaultJmsTemplate"</span>, <span class="java&#45;keyword">null</span>) // send to a literal queue<p class="paragraph"/>jmsService.send(topic: <span class="java&#45;quote">"aTopic"</span>, msg, <span class="java&#45;quote">"defaultJmsTemplate"</span>, <span class="java&#45;keyword">null</span>) // send to a literal topic<p class="paragraph"/>jmsService.send(service: <span class="java&#45;quote">"person"</span>, msg, <span class="java&#45;quote">"defaultJmsTemplate"</span>, <span class="java&#45;keyword">null</span>) // send to the queue '«appname».person'<p class="paragraph"/>jmsService.send(service: <span class="java&#45;quote">"person"</span>, method: <span class="java&#45;quote">"doIt"</span>, msg, <span class="java&#45;quote">"defaultJmsTemplate"</span>, <span class="java&#45;keyword">null</span>) // send to the queue '«appname».person.doIt'<p class="paragraph"/>jmsService.send(app: <span class="java&#45;quote">"remote"</span>, service: <span class="java&#45;quote">"person"</span>, method: <span class="java&#45;quote">"doIt"</span>, msg, <span class="java&#45;quote">"defaultJmsTemplate"</span>, <span class="java&#45;keyword">null</span>) // send to the queue 'remote.person.doIt'</pre></div><p class="paragraph"/>The app/service/method convention makes a lot more sense if you read the section below on service method listener queue subscribers.<p class="paragraph"/><strong class="bold">message</strong><p class="paragraph"/>This is the message payload. This can either be a <a href="http://java.sun.com/j2ee/1.4/docs/api/javax/jms/Message.html" target="blank">javax.jms.Message</a> or a Groovy/Java object to be <em class="italic">converted</em> into a message by the underlying <a href="http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/jms/support/converter/MessageConverter.html" target="blank">MessageConverter</a> of the <a href="http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/jms/core/JmsTemplate.html" target="blank">JmsTemplate</a> used to send the message.<p class="paragraph"/><strong class="bold">jmsTemplateBeanName</strong><p class="paragraph"/>The name of the bean in the application context that is an instance of <a href="http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/jms/core/JmsTemplate.html" target="blank">JmsTemplate</a> and that should be used to send the message. If this value is <code> null </code> , the default template that is created by this plugin will be used (called "defaultJmsTemplate").<p class="paragraph"/><strong class="bold">postProcessor</strong><p class="paragraph"/>An optional closure that can be used to "post process" the message after it has been converted into a message but before it has been sent. This closure acts as the implementation of the <a href="http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/jms/core/MessagePostProcessor.html#postProcessMessage(javax.jms.Message)" target="blank">postProcessMessage()</a> method of the <a href="http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/jms/core/MessagePostProcessor.html" target="blank">MessagePostProcessor</a> class.<p class="paragraph"/><h4>send() method variants</h4><p class="paragraph"/>There are variations of the send() method for convenience...<p class="paragraph"/><div class="code"><pre>jmsService.send(destination, message) // use the defaultJmsTemplate and no post processor
jmsService.send(destination, message, postProcessor) // use the defaultJmsTemplate</pre></div><p class="paragraph"/><h3>Sending directly from services and controllers</h3><p class="paragraph"/>The JMS plugin dynamically adds convenient methods to all your services and controllers to make sending messages easier.<p class="paragraph"/><strong class="bold">Note:</strong> each of the methods shares the same semantics as <code> jmsService.send() </code> with respect to optional arguments.<p class="paragraph"/><h4>sendJMSMessage()</h4><p class="paragraph"/>This method shares exactly the same signature and semantics as the send() method of the JmsService.<p class="paragraph"/><h4>sendQueueJMSMessage()</h4><p class="paragraph"/>This method shares exactly the same signature and semantics as the send() method of the JmsService <strong class="bold">EXCEPT</strong> that the destination argument must be a string which will be interpreted as a QUEUE name.<p class="paragraph"/><h4>sendTopicJMSMessage()</h4><p class="paragraph"/>This method shares exactly the same signature and semantics as the send() method of the JmsService <strong class="bold">EXCEPT</strong> that the destination argument must be a string which will be interpreted as a TOPIC name.<p class="paragraph"/><h4>sendPubSubJMSMessage()</h4><p class="paragraph"/>This method shares exactly the same signature and semantics as the send() method of the JmsService <strong class="bold">EXCEPT</strong> that the destination argument must be a string which will be interpreted as a TOPIC name.
	</body>
</html>